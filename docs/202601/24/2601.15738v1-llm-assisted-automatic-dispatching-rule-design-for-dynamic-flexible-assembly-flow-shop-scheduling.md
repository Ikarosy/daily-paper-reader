# LLM-Assisted Automatic Dispatching Rule Design for Dynamic Flexible Assembly Flow Shop Scheduling
# 大语言模型辅助的动态柔性装配流水车间调度自动派工规则设计

**Authors**: Junhao Qiu, Haoyang Zhuang, Fei Liu, Jianjun Liu, Qingfu Zhang \
**Date**: 2026-01-22 \
**PDF**: https://arxiv.org/pdf/2601.15738v1 \
**Tags**: <span class="tag-label tag-blue">精读区</span> <span class="tag-label tag-green">EOH</span> <span class="tag-label tag-green">EAA</span> \
**Score**: 9.0 \
**Evidence**: 大模型辅助的调度启发式算法自动设计 \
**TLDR**: 利用大语言模型自动设计动态柔性装配流水线调度的派工规则。

---

## Abstract
Dynamic multi-product delivery environments demand rapid coordination of part completion and product-level kitting within hybrid processing and assembly systems to satisfy strict hierarchical supply constraints. The flexible assembly flow shop scheduling problem formally defines dependencies for multi-stage kitting, yet dynamic variants make designing integrated scheduling rules under multi-level time coupling highly challenging. Existing automated heuristic design methods, particularly genetic programming constrained to fixed terminal symbol sets, struggle to capture and leverage dynamic uncertainties and hierarchical dependency information under transient decision states. This study develops an LLM-assisted Dynamic Rule Design framework (LLM4DRD) that automatically evolves integrated online scheduling rules adapted to scheduling features. Firstly, multi-stage processing and assembly supply decisions are transformed into feasible directed edge orderings based on heterogeneous graph. Then, an elite knowledge guided initialization embeds advanced design expertise into initial rules to enhance initial quality. Additionally, a dual-expert mechanism is introduced in which LLM-A evolutionary code to generate candidate rules and LLM-S conducts scheduling evaluation, while dynamic feature-fitting rule evolution combined with hybrid evaluation enables continuous improvement and extracts adaptive rules with strong generalization capability. A series of experiments are conducted to validate the effectiveness of the method. The average tardiness of LLM4DRD is 3.17-12.39% higher than state-of-the-art methods in 20 practical instances used for training and testing, respectively. In 24 scenarios with different resource configurations, order loads, and disturbance levels totaling 480 instances, it achieves 11.10% higher performance than the second best competitor, exhibiting excellent robustness.

## 摘要
动态多产品交付环境要求在混合加工与装配系统中快速协调零件完工和产品级配套，以满足严格的分层供应约束。柔性装配流水车间调度问题正式定义了多阶段配套的依赖关系，但其动态变体使得在多级时间耦合下设计集成调度规则极具挑战性。现有的自动启发式设计方法，特别是受限于固定终结符集的遗传编程，难以捕捉和利用瞬时决策状态下的动态不确定性和分层依赖信息。本研究开发了一个大语言模型辅助的动态规则设计框架（LLM4DRD），该框架能够自动演化出适应调度特征的集成在线调度规则。首先，基于异构图将多阶段加工和装配供应决策转化为可行的有向边排序。然后，通过精英知识引导的初始化将先进的设计专业知识嵌入初始规则中，以提高初始质量。此外，引入了一种双专家机制，其中 LLM-A 演化代码以生成候选规则，而 LLM-S 进行调度评估；同时，动态特征拟合规则演化结合混合评估实现了持续改进，并提取出具有强泛化能力的自适应规则。一系列实验验证了该方法的有效性。在用于训练和测试的 20 个实际案例中，LLM4DRD 的平均延迟性能比现有最先进方法提升了 3.17-12.39%。在包含不同资源配置、订单负载和扰动水平的 24 个场景（共 480 个实例）中，其性能比次优方法高出 11.10%，表现出卓越的鲁棒性。

---

## 论文详细总结（自动生成）

这是一份关于论文《LLM-Assisted Automatic Dispatching Rule Design for Dynamic Flexible Assembly Flow Shop Scheduling》的结构化深入总结：

### 1. 核心问题与整体含义（研究动机和背景）
*   **研究背景**：在个性化消费趋势下，制造业正从大规模生产转向小批量定制。柔性装配流水车间调度（FAFSP）涉及零件加工与产品装配的多阶段协同，且面临动态订单到达、机器故障等不确定性。
*   **核心挑战**：
    1.  **多级耦合约束**：订单交付取决于其中最晚完成的产品（配套性约束），加工与装配阶段存在时间与逻辑上的强耦合。
    2.  **动态不确定性**：传统静态调度方法无法应对实时扰动。
    3.  **现有方法局限**：传统的自动启发式设计（如遗传编程 GP）受限于固定的符号集，难以捕捉复杂的语义特征和专家设计经验。
*   **研究目的**：利用大语言模型（LLM）的逻辑推理与代码生成能力，自动设计能够适应动态环境、满足复杂配套约束的集成派工规则（PDRs）。

### 2. 方法论：LLM4DRD 框架
核心思想是构建一个**双专家协同演化框架**，将调度知识与演化算法相结合。
*   **异构图建模**：将加工和装配决策统一建模为异构图上的有向边排序问题，解决多阶段供应冲突。
*   **双专家机制**：
    *   **LLM-A（算法专家）**：负责代码生成，执行交叉（Crossover）和变异（Mutation）操作。
    *   **LLM-S（调度专家）**：负责对生成的规则进行定性分析，提供改进建议（如“增加对关键路径的关注”），形成语义反馈闭环。
*   **关键技术细节**：
    1.  **精英知识引导初始化**：不从零开始，而是利用经典规则（如 EDD）作为基准，提取其设计逻辑引导初始种群生成。
    2.  **混合评估策略**：结合定量指标（平均延迟时间）与 LLM-S 的定性评价，确保规则既有高性能又有良好的逻辑结构。
    3.  **特征拟合演化**：设计了 9 类动态状态特征（订单状态、资源利用率、到达时间等）作为输入参数，使 LLM 生成的规则能根据系统状态自适应调整优先级。
    4.  **Prompt 策略**：通过特定的 Prompt 驱动四种演化算子：优势融合交叉、探索性交叉、定向优化、参数微调。

### 3. 实验设计
*   **数据集**：结合了中国某家电制造企业的真实订单/资源数据，以及基于泊松过程生成的动态扰动实例。
*   **Benchmark 与对比方法**：
    *   **传统 AHD 方法**：遗传编程（GP）、基因表达式编程（GEP）。
    *   **SOTA LLM 框架**：EOH、FunSearch、ReEvo、MCTS-AHD。
    *   **经典启发式规则**：EDD 以及 FIFO/MOPNR/LWKR 与 SPT/EET 的 8 种组合。
*   **实验场景**：涵盖 24 种不同的资源配置、订单负载（$\mu$）和柔性因子（$\phi$），共计 480 个测试实例。

### 4. 资源与算力
*   **硬件环境**：实验在 Intel Core i5-12600KF 处理器上运行。
*   **模型使用**：主要使用 **GPT-4o-mini** 作为核心引擎。
*   **对比模型**：实验中还对比了 Qwen-72B、DeepSeek-Chat、Claude 等模型的表现。
*   **算力说明**：文中未提及具体的 GPU 训练时长，因为该方法主要依赖于 LLM API 的推理和演化搜索，而非本地模型训练。单次派工决策时间在毫秒级。

### 5. 实验数量与充分性
*   **实验规模**：
    *   **消融实验**：验证了动态特征、精英初始化、双专家机制等 6 个模块的有效性。
    *   **收敛性分析**：展示了 200 次采样过程中的性能提升曲线。
    *   **鲁棒性测试**：在 24 个不同操作条件的场景下进行了 480 组实验。
*   **充分性评价**：实验设计非常充分，不仅对比了传统方法，还对比了最新的 LLM 驱动方法，并使用了真实工业背景的数据，保证了结果的客观性与说服力。

### 6. 主要结论与发现
*   **性能领先**：LLM4DRD 在 20 个核心实例上的平均延迟比现有最先进方法降低了 **3.17% - 12.39%**。
*   **鲁棒性强**：在 480 个变动场景中，性能比次优竞争对手高出 **11.10%**，尤其在高负载和频繁扰动下优势更明显。
*   **知识演化**：证明了 LLM-S 提供的语义反馈能有效引导搜索跳出局部最优，实现比纯数值优化更持续的性能提升。

### 7. 优点（亮点）
*   **可解释性**：生成的规则以 Python 代码形式存在，相比神经网络黑盒，更易于理解和工业部署。
*   **语义闭环**：引入 LLM-S 作为调度专家，将人类专家的定性分析逻辑融入自动演化过程。
*   **端到端集成**：打破了加工与装配阶段的决策孤岛，实现了面向多产品交付的集成调度。

### 8. 不足与局限
*   **API 依赖与成本**：高度依赖商业大模型 API，在大规模演化迭代中可能产生较高的 Token 费用。
*   **约束覆盖**：虽然考虑了配套约束，但尚未涉及更复杂的二次资源约束（如模具、人力）或运输物流约束。
*   **随机性风险**：LLM 的生成具有随机性，虽然有温度控制策略，但仍可能产生无效代码，需要多次采样和校验。

（完）
